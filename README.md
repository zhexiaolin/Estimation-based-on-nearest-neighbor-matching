# Estimation based on nearest neighbor matching: from density ratio to average treatment effect

This repository provides the results for 

[Estimation based on nearest neighbor matching: from density ratio to average treatment effect](https://arxiv.org/abs/2112.13506)

Zhexiao Lin, Peng Ding, and Fang Han, 2021.



The general bias-corrected matching estimator is implemented in **matching.R**. The estimator using series estimators for regression adjustment is implemented in **estimators.R**.



## Replication

The data generating process largely follows "Using Wasserstein Generative Adversarial Networks for the Design of Monte Carlo Simulations" by Susan Athey, Guido Imbens, Jonas Metzger and Evan Munro.

**1. Clone our Github repository**

```
git clone https://github.com/zhexiaolin/Estimation-based-on-nearest-neighbor-matching
```

**2. Install the python requirements**

```
pip install -r requirements.txt
```

**3. Simulate data**

Simulated data is saved in **data** folder. Simulated LaLonde data **exp_generated.feather** is directly downloaded from https://drive.google.com/drive/folders/1CCU1zuibrPOZHK6NAAAVrX5TKQZZOMTF, generated by Athey, Susan, et al. Simulated Shadish et al. data **shadish_generated.feather** is generated by running

```
Rscript --save shadish.R
python3 gan_estimation/gan_shadish_baseline.py
```

Related figures are also saved in the folder.

**4. Compare estimators**

Run

```
Rscript --save comparison.R
Rscript --save comparison_shadish.R
```

Results are saved as **out.feather** and **out_shadish.feather** in **result** folder.

**5. Produce tables**

Run

```
Rscript --save produce_tables.R
Rscript --save produce_tables_shadish.R
```

Results are saved as **table.txt** and **table_shadish.txt** in **result** folder.
